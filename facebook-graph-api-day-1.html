<!DOCTYPE html><html lang="en-us"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Facebook Graph API Day 1 - Monospace</title><meta name="description" content="Spotsetter 라는 앱이 페이스북 컨텐츠를 가져와서 서비스에 이용하는 방식에 대해 분석한다. 페이스북을 통해&hellip;"><meta name="generator" content="Publii Open-Source CMS for Static Site"><link rel="canonical" href="https://devnoff.github.io/facebook-graph-api-day-1.html"><link rel="amphtml" href="https://devnoff.github.io/amp/facebook-graph-api-day-1.html"><link type="application/atom+xml" rel="alternate" href="https://devnoff.github.io/feed.xml"><meta property="og:title" content="Facebook Graph API Day 1"><meta property="og:site_name" content="Monospace"><meta property="og:description" content="Spotsetter 라는 앱이 페이스북 컨텐츠를 가져와서 서비스에 이용하는 방식에 대해 분석한다. 페이스북을 통해&hellip;"><meta property="og:url" content="https://devnoff.github.io/facebook-graph-api-day-1.html"><meta property="og:type" content="article"><link rel="preconnect" href="https://fonts.gstatic.com/" crossorigin><link href="https://fonts.googleapis.com/css?family=Heebo:400,500%7CPlayfair+Display:400" rel="stylesheet"><link rel="stylesheet" href="https://devnoff.github.io/assets/css/style.css?v=ddb887f76625f2c6ab96a0eba52db65d"><script type="application/ld+json">{"@context":"http://schema.org","@type":"Article","mainEntityOfPage":{"@type":"WebPage","@id":"https://devnoff.github.io/facebook-graph-api-day-1.html"},"headline":"Facebook Graph API Day 1","datePublished":"2013-07-16T17:59","dateModified":"2019-06-13T23:11","description":"Spotsetter 라는 앱이 페이스북 컨텐츠를 가져와서 서비스에 이용하는 방식에 대해 분석한다. 페이스북을 통해&hellip;","author":{"@type":"Person","name":"devnoff"},"publisher":{"@type":"Organization","name":"devnoff"}}</script><script async src="https://devnoff.github.io/assets/js/lazysizes.min.js?v=9c0e65e25f8f098037678ba0c2be1d9f"></script></head><body><div class="container"><header><a class="logo" href="https://devnoff.github.io/">Monospace</a><div class="top"><div class="top__search"><form action="https://devnoff.github.io/search.html" class="search"><input type="search" name="q" placeholder="search..."></form></div></div></header><main><article class="post u-wrapper"><header class="hero"><p class="post__meta">By <a href="https://devnoff.github.io/authors/devnoff/" rel="author" title="devnoff">devnoff</a> Published on <time datetime="2013-07-16T17:59">July 16, 2013</time></p><h1 class="post__title">Facebook Graph API Day 1</h1></header><div class="post__entry"><p>Spotsetter 라는 앱이 페이스북 컨텐츠를 가져와서 서비스에 이용하는 방식에 대해 분석한다. 페이스북을 통해 트래블로그에 가입한 유저에 대해서 아래의 조건에 대한 컨텐츠를 가져오는 방법을 알아보았다.</p><ol><li>유저가 페이스북에서 작성한 게시글 중 플레이스 정보가 있는 것 가져오기</li><li>유저가 페이스북에서 체크인하거나 유저의 친구의 채크인(또는 상태)에 태그가 된 것 가져오기</li><li>유저의 페이스북 친구들이 체크인 하거나 그들의 친구들의 체크인(또는 상태)에 태그가 된 것 가져오기</li><li>특정 Region 에 속한 게시글(본인 및 친구가 작성하거나 태그된) 가져오기</li><li>특정 Place의 게시글(본인 및 친구가 작성하거나 태그된) 가져오기</li><li>유저가 like한 컨텐츠 가져오기(유저 성향 분석)</li></ol><p>조건에 따라 FQL(Facebook Query Language) 과 Graph API 중 쿼리하기 용이한 것을 이용하였다.</p><p><strong>1. 유저가 페이스북에서 작성한 게시글 중 플레이스 정보가 있는 것 가져오기</strong></p><p>이에 대한 쿼리문을 작성하면서 테이블 컬럼의 네이밍만으로 각 테이블간 관계를 파악하기가 조금 어려웠다. 엔티티들의 특성을 고려하여 관계를 추정하여 아래의 쿼리를 통해 위의 조건에 해당하는 결과를 얻을 수 있었다.</p><p>{"status":"select place_id, status_id, message from status where status_id IN (select id from location_post where author_uid = me())","checkin":"select target_id, message from checkin where checkin_id IN (select id from location_post where author_uid = me())"}</p><p><span style="text-decoration:underline;">Descriptions</span></p><ul><li>location_post.id : ID of the object associated with this location</li><li>status.status_id : The ID of the status message</li><li>checkin.checkin_id : The ID of the check-in.</li><li>checkin.target_id : The ID of Event or Page the user is checking into.</li><li>place.page_id : The Facebook Page ID of the place</li></ul><p>location_post 테이블의 id  는 위치정보가 있는 object 를 가리키고, checkin 테이블의 target_id 는 place테이블의 page_id를 가르킨다.</p><p><strong>2. 유저가 페이스북에서 체크인하거나 유저의 친구의 채크인(또는 상태)에 태그가 된 것 가져오기</strong></p><p>Graph API - "user_id/checkins"</p><p><strong>3. 유저의 페이스북 친구들이 체크인 하거나 그들의 친구들의 체크인(또는 상태)에 태그가 된 것 가져오기</strong></p><p>Graph API - "user_id?fields=friends.offset(0).limit(20).fields(checkins.fields(coordinates,place,from),name,picture)"</p><p><strong>4. 특정 Region 에 속한 게시글(본인 및 친구가 작성하거나 태그된) 가져오기</strong></p><p>Graph API 로는 좌표를 이용한 특정 Region 에 대한 위의 쿼리는 불가능 하다. FQL 을 이용하면 쿼리가 가능하긴 하나 'join' 문을 사용할 수 없어서 한번에 데이터를 가져오는데 한계가 있다. 이 시점에 Spotsetter 가 어떻게 서비스를 구현해냈는지 추측할 수 있는데, 최초 페이스북과 연동 후 위의 2,3번 Graph API 를 이용해 사용자 데이터를 모두 가져와 캐싱을하여 자체 DB에서 쿼리를 한 것 일것이다. 캐싱없이 실시간으로 API 를 호출해서 데이터를 만들어 낼 수는 있지만, 원하는 형태의 데이터를 만들기 위해서 매우 비효율적인 과정을 거쳐야 하기때문에 이를 이용하지 않았을 것이며, 앱의 반응속도로 보아 캐싱을 한 것이 틀림 없어 보인다.</p><p><strong>5. 특정 Place의 게시글(본인 및 친구가 작성하거나 태그된) 가져오기</strong></p><p>4와 마찬가지로 구현</p><p><strong>6. 유저가 like한 컨텐츠 가져오기(유저 성향 분석)</strong></p><p>Graph API - "user_id/likes"</p><p>유저가 like한 페이지 목록을 가져온다</p><p>[code language="javascript" gutter="false" autolinks="false"]</p><p>{<br>&quot;data&quot;: [<br>{<br>&quot;category&quot;: &quot;Tv show&quot;,<br>&quot;name&quot;: &quot;쇼미더머니 2&quot;,<br>&quot;created_time&quot;: &quot;2013-07-05T14:37:32+0000&quot;,<br>&quot;id&quot;: &quot;138621366340709&quot;<br>},<br>{<br>&quot;category&quot;: &quot;Company&quot;,<br>&quot;name&quot;: &quot;Lomography Embassy Store Seoul&quot;,<br>&quot;created_time&quot;: &quot;2013-06-15T08:59:30+0000&quot;,<br>&quot;id&quot;: &quot;180737175415514&quot;<br>}<br>],<br>&quot;paging&quot;: {<br>&quot;next&quot;: &quot;https://graph.facebook.com/xxxxxxx/likes?limit=2&amp;offset=2&amp;__after_id=180737175415514&quot;<br>}<br>}</p><p>[/code]</p><p>References</p><ul><li><a href="https://developers.facebook.com/docs/reference/api/" target="_blank">Facebook Graph API</a></li><li><a href="https://developers.facebook.com/docs/reference/fql/" target="_blank">Facebook FQL</a></li><li><a href="https://developers.facebook.com/tools/explorer" target="_blank">Graph API Explorer</a></li></ul></div><footer class="post__footer"><div class="post__last-updated">This article was updated on June 13, 2019</div><div class="post__footer__col"><div class="post__share"></div></div><nav class="post__nav"><div class="post__nav__prev">Previous Post<h5><a href="https://devnoff.github.io/bug-fixing-deals-hong-kong-integration-tracking-users-behaviors.html" class="inverse" rel="prev">Bug Fixing, Deals Hong Kong Integration, Tracking User&#x27;s Behaviors</a></h5></div><div class="post__nav__next">Next Post<h5><a href="https://devnoff.github.io/usage-analysis-3-days.html" class="inverse" rel="next">Usage Analysis 3 Days</a></h5></div></nav><div class="post__bio"><div><h3><a href="https://devnoff.github.io/authors/devnoff/" class="inverse" title="devnoff">devnoff</a></h3></div></div><div class="post__related"><h3 class="u-h5">Related posts</h3><div class="post__related__wrap"><figure><figcaption><h4><a href="https://devnoff.github.io/facebook-open-graph-day-5.html" class="inverse">Facebook Open Graph – Day 5</a></h4><time datetime="2013-07-05T12:25">July 5, 2013</time></figcaption></figure><figure><figcaption><h4><a href="https://devnoff.github.io/facebook-open-graph-day-4.html" class="inverse">Facebook Open Graph - Day 4</a></h4><time datetime="2013-07-04T12:45">July 4, 2013</time></figcaption></figure><figure><figcaption><h4><a href="https://devnoff.github.io/facebook-open-graph-day-3.html" class="inverse">Facebook Open Graph – Day 3</a></h4><time datetime="2013-07-03T18:34">July 3, 2013</time></figcaption></figure></div></div></footer></article></main><footer class="footer"><div class="footer__copyright">©2019 DEVNOFF</div></footer></div><script defer="defer" src="https://devnoff.github.io/assets/js/jquery-3.2.1.slim.min.js?v=5f48fc77cac90c4778fa24ec9c57f37d"></script><script defer="defer" src="https://devnoff.github.io/assets/js/scripts.min.js?v=16be857f09f55a0c76ea5e92e1f5f9d0"></script><script async src="https://www.googletagmanager.com/gtag/js?id=UA-142191638-1"></script><script>window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-142191638-1');</script></body></html>