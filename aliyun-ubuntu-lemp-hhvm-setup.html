<!DOCTYPE html><html lang="en-us"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Aliyun Ubuntu LEMP HHVM Setup - Monospace</title><meta name="description" content="Aliyun ECS 인스턴스를 생성 후 LEMP + HHVM 을 세팅하기 까지 과정&hellip;"><meta name="generator" content="Publii Open-Source CMS for Static Site"><link rel="canonical" href="https://devnoff.github.io/aliyun-ubuntu-lemp-hhvm-setup.html"><link rel="amphtml" href="https://devnoff.github.io/amp/aliyun-ubuntu-lemp-hhvm-setup.html"><link type="application/atom+xml" rel="alternate" href="https://devnoff.github.io/feed.xml"><meta property="og:title" content="Aliyun Ubuntu LEMP HHVM Setup"><meta property="og:site_name" content="Monospace"><meta property="og:description" content="Aliyun ECS 인스턴스를 생성 후 LEMP + HHVM 을 세팅하기 까지 과정&hellip;"><meta property="og:url" content="https://devnoff.github.io/aliyun-ubuntu-lemp-hhvm-setup.html"><meta property="og:type" content="article"><link rel="preconnect" href="https://fonts.gstatic.com/" crossorigin><link href="https://fonts.googleapis.com/css?family=Heebo:400,500%7CPlayfair+Display:400" rel="stylesheet"><link rel="stylesheet" href="https://devnoff.github.io/assets/css/style.css?v=ddb887f76625f2c6ab96a0eba52db65d"><script type="application/ld+json">{"@context":"http://schema.org","@type":"Article","mainEntityOfPage":{"@type":"WebPage","@id":"https://devnoff.github.io/aliyun-ubuntu-lemp-hhvm-setup.html"},"headline":"Aliyun Ubuntu LEMP HHVM Setup","datePublished":"2016-02-26T15:08","dateModified":"2019-06-13T23:13","description":"Aliyun ECS 인스턴스를 생성 후 LEMP + HHVM 을 세팅하기 까지 과정&hellip;","author":{"@type":"Person","name":"devnoff"},"publisher":{"@type":"Organization","name":"devnoff"}}</script><script async src="https://devnoff.github.io/assets/js/lazysizes.min.js?v=9c0e65e25f8f098037678ba0c2be1d9f"></script></head><body><div class="container"><header><a class="logo" href="https://devnoff.github.io/">Monospace</a><div class="top"><div class="top__search"><form action="https://devnoff.github.io/search.html" class="search"><input type="search" name="q" placeholder="search..."></form></div></div></header><main><article class="post u-wrapper"><header class="hero"><p class="post__meta">By <a href="https://devnoff.github.io/authors/devnoff/" rel="author" title="devnoff">devnoff</a> Published on <time datetime="2016-02-26T15:08">February 26, 2016</time></p><h1 class="post__title">Aliyun Ubuntu LEMP HHVM Setup</h1></header><div class="post__entry"><p>Aliyun ECS 인스턴스를 생성 후 LEMP + HHVM 을 세팅하기 까지 과정</p><h4>1. 사용자 추가</h4><p>쉘에 접속 후 root 계정을 대신해 사용할 수 있는 관리자 계정을 생성한다.</p><p>[code language="bash"]</p><p>root@iZ11ngunt9tZ:/# adduser devnoff<br>Adding user `devnoff' ...<br>Adding new group `devnoff' (1000) ...<br>Adding new user `devnoff' (1000) with group `devnoff' ...<br>Enter new UNIX password:<br>Retype new UNIX password:<br>passwd: password updated successfully<br>Changing the user information for devnoff<br>Enter the new value, or press ENTER for the default<br>Full Name []: devnoff<br>Room Number []:<br>Work Phone []:<br>Home Phone []:<br>Other []:<br>Is the information correct? [Y/n] Y</p><p>[/code]</p><p>초기화 된 우분투에서 adduser를 하였는데, locale 설정 에러가 떴다.<br>이문제는 다음 코드로 해결</p><p>[code]<br>export LANGUAGE=en_US.UTF-8<br>export LANG=en_US.UTF-8<br>export LC_ALL=en_US.UTF-8<br>locale-gen en_US.UTF-8<br>dpkg-reconfigure locales<br>[/code]</p><h4>2. 추가한 사용자에게 sudo 권한 부여</h4><ul><li>/etc/sudoers 쓰기 권한 부여: # chmod u+w /etc/sudoers</li><li>root 계정 아래에 'devnoff ALL=(ALL:ALL) ALL' 추가</li><li>/etc/sudoers 권한 돌려 놓기: # chmod u-w /etc/sudoers</li></ul><h4>3. NginX + MariaDB + PHP 설치</h4><p><strong>Nginx</strong></p><ul><li>sudo apt-get update</li><li>sudo apt-get install nginx</li></ul><p><strong>MariaDB</strong></p><p>10.1 버전 설치를 위한 리포지 토리 추가</p><p>[code]<br>sudo apt-get install software-properties-common<br>sudo apt-key adv --recv-keys --keyserver hkp://keyserver.ubuntu.com:80 0xcbcb082a1bb943db<br>sudo add-apt-repository 'deb [arch=amd64,i386] http://mirrors.opencas.cn/mariadb/repo/10.1/ubuntu trusty main'<br>[/code]</p><p>설치</p><p>[code]<br>sudo apt-get update<br>sudo apt-get install mariadb-server<br>[/code]</p><p>시스템 시작시 실행하도록</p><p>[code]<br>sudo update-rc.d mysql defaults<br>[/code]</p><p><strong>PHP</strong></p><p>5.6 버전 설치 설정</p><p>[code]<br>sudo add-apt-repository ppa:ondrej/php5-5.6<br>[/code]</p><p>[code]<br>sudo apt-get update<br>[/code]</p><p>[code]<br>sudo apt-get install php5 php5-fpm php5-mysql<br>[/code]</p><p>보안을 위한 php.ini 변경</p><p>[code]<br>sudo nano /etc/php5/fpm/php.ini<br>[/code]</p><p>[code]<br>cgi.fix_pathinfo=0<br>[/code]</p><p>php5-fpm 재시동</p><p>[code]<br>sudo service php5-fpm restart<br>[/code]</p><p>NginX 설정</p><p>[code]<br>server {<br>client_max_body_size 20M;<br>listen 80;<br>server_name localhost;<br>root /home/devnoff/www;<br>index index.php;</p><p>location = /favicon.ico {<br>log_not_found off;<br>access_log off;<br>}</p><p>location = /robots.txt {<br>allow all;<br>log_not_found off;<br>access_log off;<br>}</p><p>location / {<br># This is cool because no php is touched for static content.<br># include the &amp;amp;amp;amp;quot;?$args&amp;amp;amp;amp;quot; part so non-default permalinks doesn't break when using query string<br>try_files $uri $uri/ /index.php?$args;<br>}</p><p>error_log /home/devnoff/travelog_wp/error.log error;</p><p>location ~ \.php$ {<br>fastcgi_pass unix:/var/run/php5-fpm.sock;<br>fastcgi_index index.php;<br>fastcgi_split_path_info ^(.+\.php)(.*)$;<br>fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;<br>include fastcgi_params;<br>fastcgi_read_timeout 600;<br>}<br>location ~* \.(js|css|png|jpg|jpeg|gif|ico)$ {<br>expires max;<br>log_not_found off;<br>}<br>}<br>[/code]</p><p>NginX 재시동</p><p>[code]<br>sudo service nginx restart<br>[/code]</p><p><strong>HHVM 설치</strong></p><p>[code]<br>wget -O - http://mirrors.noc.im/hhvm/conf/hhvm.gpg.key | sudo apt-key add -<br>echo deb http://mirrors.noc.im/hhvm/ubuntu trusty main | sudo tee /etc/apt/sources.list.d/hhvm.list<br>sudo apt-get update<br>sudo apt-get install hhvm<br>[/code]</p><p>NginX PHP 설정 주석 처리</p><p>[code]<br># location ~ \.php$ {<br># fastcgi_pass unix:/var/run/php5-fpm.sock;<br># fastcgi_index index.php;<br># fastcgi_split_path_info ^(.+\.php)(.*)$;<br># fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;<br># include fastcgi_params;<br># fastcgi_read_timeout 600;<br># }<br>[/code]</p><p>스크립트 실행</p><p>[code]<br>sudo /usr/share/hhvm/install_fastcgi.sh<br>[/code]</p><p>mysql 튜너<br>http://mysqltuner.com/</p></div><footer class="post__footer"><div class="post__last-updated">This article was updated on June 13, 2019</div><div class="post__footer__col"><ul class="post__tag"><li><a href="https://devnoff.github.io/aliyun/">aliyun</a></li><li><a href="https://devnoff.github.io/hhvm/">hhvm</a></li><li><a href="https://devnoff.github.io/lemp/">lemp</a></li><li><a href="https://devnoff.github.io/ubuntu/">ubuntu</a></li></ul><div class="post__share"></div></div><nav class="post__nav"><div class="post__nav__prev">Previous Post<h5><a href="https://devnoff.github.io/ubuntu-rinugseu-sayongjareul-geurube-cugahagi.html" class="inverse" rel="prev">우분투 리눅스: 사용자를 그룹에 추가하기</a></h5></div><div class="post__nav__next">Next Post<h5><a href="https://devnoff.github.io/aws-auto-scaling-mysql-read-replication.html" class="inverse" rel="next">AWS Auto Scaling, MySQL Read replication</a></h5></div></nav><div class="post__bio"><div><h3><a href="https://devnoff.github.io/authors/devnoff/" class="inverse" title="devnoff">devnoff</a></h3></div></div><div class="post__related"><h3 class="u-h5">Related posts</h3><div class="post__related__wrap"><figure><figcaption><h4><a href="https://devnoff.github.io/ubuntu-rinugseu-sayongjareul-geurube-cugahagi.html" class="inverse">우분투 리눅스: 사용자를 그룹에 추가하기</a></h4><time datetime="2016-01-23T22:46">January 23, 2016</time></figcaption></figure></div></div></footer></article></main><footer class="footer"><div class="footer__copyright">©2019 DEVNOFF</div></footer></div><script defer="defer" src="https://devnoff.github.io/assets/js/jquery-3.2.1.slim.min.js?v=5f48fc77cac90c4778fa24ec9c57f37d"></script><script defer="defer" src="https://devnoff.github.io/assets/js/scripts.min.js?v=16be857f09f55a0c76ea5e92e1f5f9d0"></script><script async src="https://www.googletagmanager.com/gtag/js?id=UA-142191638-1"></script><script>window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-142191638-1');</script></body></html>